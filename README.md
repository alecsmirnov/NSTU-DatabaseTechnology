# Лабораторные работы по дисциплине "Технологии баз данных" на факультете ПМИ, НГТУ
&nbsp; 

## queries
Запросы к сделанным лабораторным работам.  
&nbsp; 

## lab_4. Встроенный SQL
### Запросы из варианта

1. Выдать число деталей, поставлявшихся для изделий, у которых есть поставки с весом от 5000 до 6000.
2. Поменять местами вес деталей из Рима и из Парижа, т. е. деталям из Рима установить вес детали из Парижа, а деталям из Парижа установить вес детали из Рима. Если деталей несколько, брать наименьший вес.
3. Найти детали, имеющие поставки, объем которых не превышает половину максимального объема поставки этой детали поставщиком из Парижа.
4. Выбрать поставщиков, не поставивших ни одной из деталей, поставляемых для изделий из Парижа.
5. Выдать полную информацию о деталях, которые поставлялись ТОЛЬКО поставщиками, проживающими в Афинах.

### Условия задачи

1. Разработать и отладить ESQL/С-программу, реализующую задачу 1 из соответствующего варианта заданий, результатом которой
является единственная строка.
2. Разработать и отладить ESQL/С-программу, реализующую задачу 2 из соответствующего варианта заданий и связанную с модификацией
базы данных.
3. Изучить синтаксис и правила использования операторов Declare, Open, Fetch, Close, а также особенности работы с курсором.
4. Разработать и отладить набор ESQL/С-программ, решающих задачи 3–5 из соответствующего варианта заданий с использованием 
аппарата курсоров (последовательного и скроллирующего). Результатом работы программ является набор строк, которые подлежат выводу на 
экран с соответствующими пояснительными заголовками.  
&nbsp; 

## lab_5. Динамический SQL
### Запросы из варианта 

1. Получить число поставок для каждого поставщика и найти их среднее.
2. Для каждого изделия из указанного города найти суммарный объем поставок по каждой детали, для него поставлявшейся. Вывести номер изделия, название изде-лия, номер детали, название детали, цвет детали, суммарный объем поставок дета-ли для изделия.
3. Ввести номер детали P*. Найти города, в которые поставлялась деталь P*, и опреде-лить, какой процент составляют поставки в каждый город от общего числа поставок детали P*. Вывести город, число поставок деталей в этот город, общее число поста-вок детали P*, процент.

### Условия задачи

1. Изучить синтаксис и правила использования операторов Prepare, Execute, а также особенности работы с курсором при выполнении динамического оператора SQL.
2. Разработать и отладить набор ESQL/С-программ, решающих задачи из соответствующего варианта заданий. Результатом работы программ является одна или несколько строк, которые подлежат выводу на экран с соответствующими пояснительными заголовками.  
&nbsp; 


## lab_9. Технология Activex Data Objects (ADO)
### Запросы из варианта 

1. Для каждого изделия на конец каждого года получить:
    * размер максимальной поставки;
    * сумму, на которую выполнены поставки для изделия;
    * процент этой суммы от общей суммы по всем изделиям за год. 
    * Упорядочить по году и проценту. Выделить строки, где процент не меньше 50.  
2. Для указанных изделия и года по каждой поставке вывести:
    * сумму поставки;
    * разницу между ценой детали в поставке и средней ценой детали за год.
3. Изменить цену детали в поставке.

### Условия задачи

Разрабатываемое приложение должно удовлетворять следующимтребованиям:
* Приложение должно включать в себя три формы:  
    – модуль данных, содержащий все необходимые компоненты для работы с базой данных;  
    – форму для просмотра выборок данных;  
    – форму для выполнения запроса модификации данных.
* Соединение с базой данных должно выполняться через компонент ADOConnection. Для выборки данных использовать ADOQuery.
* Модификация данных должна выполняться либо серверной функцией, вызываемой из приложения через ADOStoredProc, либо запросом через ADOQuery.
* Просмотр выборок должен осуществляться через компоненты DBGrid. Просмотр должен быть согласованным (выборка по второму запросу должна выполняться для текущей строки выборки по первому запросу). Строки выборок должны быть отсортированы по указанным в задании столбцам. Названия столбцов должны быть на русском языке. Строки выборок, удовлетворяющие указанным в задании условиям, должны быть выделены (цветом фона и/или цветом/стилем шрифта).
* Визуализация формы для выполнения запроса на модификацию может вызываться либо нажатием кнопки, либо через контекстное меню.
* Ввод параметров для модификации данных может быть осуществлен либо путем ввода значений в текстовом виде, либо посредством выбора значений из предлагаемого списка.
* После модификации данных должно появляться сообщение о том, насколько успешно прошла модификация.
* В случае возникновения ошибки должно выдаваться соответствующие сообщение.
